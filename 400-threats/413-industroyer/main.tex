% ============================================================================
%  Industroyer/CrashOverride - OT Security Learning Resource
% ============================================================================

\documentclass[11pt,a4paper]{article}
\usepackage{otsec-template}
\usepackage{float}

% Define colors for TikZ
\colorlet{otprimary}{primary}
\colorlet{otaccent}{accent}
\colorlet{otsuccess}{success}
\colorlet{otwarning}{warning}
\colorlet{otdanger}{danger}
\colorlet{otinfo}{info}

\hypersetup{
    pdftitle={Industroyer/CrashOverride},
    pdfsubject={Analysis of the Grid-Targeting Malware},
}

\begin{document}

% ----------------------------------------------------------------------------
%  TITLE PAGE
% ----------------------------------------------------------------------------

\maketitlepage
    {Industroyer / CrashOverride}
    {Analysis of Grid-Targeting Malware}
    {OT Security Learning Series}
    {Document 413 \quad|\quad January 2026}
    {Matthias Niedermaier}

% ----------------------------------------------------------------------------
%  TABLE OF CONTENTS
% ----------------------------------------------------------------------------

\tableofcontents
\newpage

% ----------------------------------------------------------------------------
%  INTRODUCTION
% ----------------------------------------------------------------------------

\section{Introduction}

Industroyer (also known as CrashOverride) is sophisticated malware specifically designed to attack electric power grids. It was used in the December 2016 cyberattack on Ukraine's power grid, causing a blackout in Kyiv that affected approximately one-fifth of the city's power consumption.

\begin{dangerbox}
Industroyer is only the second known malware (after Stuxnet) specifically designed to disrupt physical industrial processes. It demonstrates nation-state capability to attack critical infrastructure.
\end{dangerbox}

\subsection{Incident Overview}

\begin{center}
\small
\rowcolors{2}{lightgray}{white}
\begin{tabular}{p{4cm}p{9cm}}
\rowcolor{primary}
\textcolor{white}{\bfseries Attribute} & \textcolor{white}{\bfseries Details} \\
\midrule
Date & December 17, 2016 \\
Target & Ukrenergo (Ukrainian power transmission) \\
Location & Pivnichna substation, Kyiv region \\
Impact & Approximately 200MW load disconnected, 1-hour outage \\
Attribution & Sandworm Team (Russian GRU Unit 74455) \\
Discovery & ESET and Dragos (June 2017) \\
\end{tabular}
\end{center}

% ----------------------------------------------------------------------------
%  MALWARE ARCHITECTURE
% ----------------------------------------------------------------------------

\section{Malware Architecture}

\subsection{Modular Design}

Industroyer uses a highly modular architecture:

\begin{conceptbox}{Component Structure}
\begin{itemize}
    \item \textbf{Main backdoor:} C2 communication, orchestration
    \item \textbf{Additional backdoor:} Persistence mechanism
    \item \textbf{Launcher:} Executes payloads at scheduled time
    \item \textbf{Payload modules:} Protocol-specific attack components
    \item \textbf{Data wiper:} Destroys evidence and damages systems
\end{itemize}
\end{conceptbox}

\begin{figure}[H]
\centering
\begin{tikzpicture}[
    module/.style={rectangle, draw, thick, rounded corners=3pt, minimum width=2.2cm, minimum height=0.8cm, align=center, font=\scriptsize\bfseries},
    arrow/.style={->, thick, >=stealth}
]

% Main backdoor at top
\node[module, fill=otdanger!20] (backdoor) at (5,3) {Main Backdoor\\(C2)};

% Launcher
\node[module, fill=otwarning!20] (launcher) at (5,1.5) {Launcher};

% Protocol modules
\node[module, fill=otinfo!20] (iec101) at (0,0) {IEC 101};
\node[module, fill=otinfo!20] (iec104) at (2.5,0) {IEC 104};
\node[module, fill=otinfo!20] (iec61850) at (5,0) {IEC 61850};
\node[module, fill=otinfo!20] (opcda) at (7.5,0) {OPC DA};
\node[module, fill=otdanger!20] (wiper) at (10,0) {Data Wiper};

% Arrows
\draw[arrow, otdanger] (backdoor) -- (launcher);
\draw[arrow, otwarning] (launcher) -- (iec101);
\draw[arrow, otwarning] (launcher) -- (iec104);
\draw[arrow, otwarning] (launcher) -- (iec61850);
\draw[arrow, otwarning] (launcher) -- (opcda);
\draw[arrow, otdanger] (launcher) -- (wiper);

% Target label
\node[font=\tiny, below] at (5,-0.7) {Protocol-specific attack modules};

\end{tikzpicture}
\caption{Industroyer Modular Architecture}
\end{figure}

\subsection{ICS Protocol Modules}

The malware includes four payload modules targeting industrial protocols:

\begin{center}
\small
\rowcolors{2}{lightgray}{white}
\begin{tabular}{p{3cm}p{10cm}}
\rowcolor{primary}
\textcolor{white}{\bfseries Protocol} & \textcolor{white}{\bfseries Attack Capability} \\
\midrule
IEC 60870-5-101 & Serial communication with RTUs \\
IEC 60870-5-104 & TCP/IP communication with RTUs (primary attack vector) \\
IEC 61850 & Substation automation, GOOSE messaging \\
OPC DA & Data access to SCADA historians and HMIs \\
\end{tabular}
\end{center}

\begin{warningbox}
The inclusion of multiple protocol modules shows extensive knowledge of power grid systems. This indicates significant reconnaissance and development resources.
\end{warningbox}

% ----------------------------------------------------------------------------
%  ATTACK SEQUENCE
% ----------------------------------------------------------------------------

\section{Attack Sequence}

\subsection{Attack Timeline}

\begin{figure}[H]
\centering
\begin{tikzpicture}[scale=0.9]
    % Timeline
    \draw[->, line width=1pt] (0,0) -- (13,0);

    % Time markers
    \foreach \x/\time in {1/23:50, 4/00:00, 7/00:10, 10/00:15, 13/01:00} {
        \draw[line width=0.5pt] (\x,-0.15) -- (\x,0.15);
        \node[font=\scriptsize] at (\x,-0.5) {\time};
    }

    % Date label
    \node[font=\small\bfseries] at (6.5,-1.2) {December 17, 2016};

    % Events
    \node[fill=otwarning!30, rounded corners, font=\scriptsize, align=center, anchor=south, text width=2cm] at (1,0.3) {Launcher\\activates};
    \node[fill=otdanger!30, rounded corners, font=\scriptsize, align=center, anchor=south, text width=2cm] at (4,0.3) {IEC 104\\scanning};
    \node[fill=otdanger!30, rounded corners, font=\scriptsize, align=center, anchor=south, text width=2cm] at (7,0.3) {Breakers\\opened};
    \node[fill=otdanger!30, rounded corners, font=\scriptsize, align=center, anchor=south, text width=2cm] at (10,0.3) {Data wiper\\runs};
    \node[fill=otsuccess!30, rounded corners, font=\scriptsize, align=center, anchor=south, text width=2cm] at (13,0.3) {Manual\\restoration};

\end{tikzpicture}
\caption{Industroyer Attack Timeline}
\end{figure}

\subsection{Kill Chain}

\begin{figure}[H]
\centering
\begin{tikzpicture}[
    box/.style={rectangle, draw, thick, rounded corners=3pt, minimum width=2cm, minimum height=1cm, align=center, font=\small},
    arrow/.style={->, very thick, >=stealth}
]

% Attack path
\node[box, fill=otdanger!20] (phish) at (0,0) {Initial\\Access};
\node[box, fill=otwarning!20] (it) at (3.2,0) {Enterprise\\Network};
\node[box, fill=otwarning!20] (ot) at (6.4,0) {OT\\Network};
\node[box, fill=otdanger!20] (iec) at (9.6,0) {IEC 104\\Commands};
\node[box, fill=otdanger!20] (breaker) at (12.8,0) {Blackout};

\draw[arrow, otdanger] (phish) -- (it);
\draw[arrow, otdanger] (it) -- (ot);
\draw[arrow, otdanger] (ot) -- (iec);
\draw[arrow, otdanger] (iec) -- (breaker);

% Labels
\node[font=\tiny, below] at (1.6,-0.7) {Backdoor};
\node[font=\tiny, below] at (4.8,-0.7) {Pivot};
\node[font=\tiny, below] at (8,-0.7) {Open breakers};
\node[font=\tiny, below] at (11.2,-0.7) {200MW lost};

\end{tikzpicture}
\caption{Industroyer Attack Path}
\end{figure}

\begin{enumerate}
    \item \textbf{Initial access:} Spearphishing or supply chain compromise
    \item \textbf{Lateral movement:} Spread through enterprise network
    \item \textbf{OT network access:} Pivoted to control system network
    \item \textbf{Reconnaissance:} Mapped network and identified targets
    \item \textbf{Staging:} Deployed malware components
    \item \textbf{Execution:} Launched attack at midnight local time
    \item \textbf{Impact:} Opened circuit breakers, caused blackout
    \item \textbf{Cleanup:} Data wiper attempted to destroy evidence
\end{enumerate}

\subsection{IEC 104 Attack Details}

The IEC 60870-5-104 module performed these actions:

\begin{itemize}
    \item Scanned network for IEC 104 devices
    \item Enumerated Information Object Addresses (IOAs)
    \item Sent unauthorized commands to open circuit breakers
    \item Issued single-point and double-point commands
    \item Toggled breakers repeatedly to prevent manual restoration
\end{itemize}

\subsection{Attack Timeline}

\begin{center}
\small
\rowcolors{2}{lightgray}{white}
\begin{tabular}{p{3cm}p{10cm}}
\rowcolor{primary}
\textcolor{white}{\bfseries Time} & \textcolor{white}{\bfseries Event} \\
\midrule
23:50 & Launcher component activates \\
00:00 & IEC 104 module begins scanning \\
00:05 & Unauthorized commands sent to breakers \\
00:10 & Multiple substations affected \\
00:15 & Data wiper activates \\
01:00+ & Manual restoration begins \\
\end{tabular}
\end{center}

% ----------------------------------------------------------------------------
%  TECHNICAL ANALYSIS
% ----------------------------------------------------------------------------

\section{Technical Analysis}

\subsection{Main Backdoor}

\begin{itemize}
    \item Written in C++, compiled for Windows
    \item Communicates via HTTPS to C2 servers
    \item Uses Tor for anonymization (optional)
    \item Supports file upload/download, shell commands
    \item Configurable via XML configuration files
\end{itemize}

\subsection{Launcher Component}

\begin{tipbox}
The launcher uses Windows scheduled tasks to execute payloads at a specific time. This allows attackers to:
\begin{itemize}
    \item Coordinate attacks across multiple systems
    \item Execute during low-staffing periods (midnight)
    \item Maintain operational security until attack time
\end{itemize}
\end{tipbox}

\subsection{Data Wiper}

The wiper component:
\begin{itemize}
    \item Overwrites files with random data
    \item Targets Windows registry and system files
    \item Attempts to make systems unbootable
    \item Designed to hamper forensic investigation
\end{itemize}

% ----------------------------------------------------------------------------
%  COMPARISON WITH OTHER ATTACKS
% ----------------------------------------------------------------------------

\section{Comparison with 2015 Attack}

\begin{center}
\small
\rowcolors{2}{lightgray}{white}
\begin{tabular}{p{4cm}p{4.5cm}p{4.5cm}}
\rowcolor{primary}
\textcolor{white}{\bfseries Aspect} & \textcolor{white}{\bfseries 2015 Attack} & \textcolor{white}{\bfseries 2016 (Industroyer)} \\
\midrule
Method & Manual (remote desktop) & Automated malware \\
Protocols used & Proprietary SCADA & IEC 104, IEC 61850 \\
Scale & 3 utilities, 225,000 affected & 1 utility, smaller impact \\
Sophistication & Medium & High \\
Reusability & Low (manual) & High (modular) \\
Recovery impact & Firmware damage & Data wiping \\
\end{tabular}
\end{center}

\begin{infobox}
Industroyer represents an evolution from manual attacks to automated, repeatable capabilities. The modular design allows rapid adaptation to different targets.
\end{infobox}

\begin{figure}[H]
\centering
\begin{tikzpicture}[
    impact/.style={rectangle, draw, thick, fill=otdanger!15, minimum width=5.5cm, minimum height=0.7cm, rounded corners=3pt, font=\small, align=left}
]

\node[impact] at (0,2) {\faIcon{bolt} ~200MW load disconnected};
\node[impact] at (0,1) {\faIcon{city} Portion of Kyiv without power};
\node[impact] at (0,0) {\faIcon{clock} ~1 hour blackout};
\node[impact] at (0,-1) {\faIcon{hdd} Systems wiped to hinder forensics};
\node[impact] at (0,-2) {\faIcon{code} First grid-specific ICS malware};

\end{tikzpicture}
\caption{Industroyer Attack Impact}
\end{figure}

% ----------------------------------------------------------------------------
%  DETECTION AND DEFENSE
% ----------------------------------------------------------------------------

\section{Detection and Defense}

\subsection{Indicators of Compromise}

Key detection opportunities:

\begin{itemize}
    \item Unusual IEC 104 traffic patterns or command sequences
    \item Unauthorized connections to RTU/IED addresses
    \item Scheduled tasks created with suspicious names
    \item Tor network connections from OT systems
    \item File modifications in system directories
\end{itemize}

\subsection{Defensive Measures}

\begin{successbox}
\textbf{Recommended defenses:}
\begin{itemize}
    \item Network segmentation between IT and OT
    \item ICS-aware intrusion detection systems
    \item Application whitelisting on SCADA servers
    \item Monitoring of IEC 104/61850 protocol traffic
    \item Offline backups of critical configurations
    \item Incident response plans for grid emergencies
\end{itemize}
\end{successbox}

\subsection{Protocol-Specific Protections}

\begin{itemize}
    \item \textbf{IEC 62351:} Security extensions for IEC 60870-5 and 61850
    \item \textbf{Command validation:} Verify commands against expected operations
    \item \textbf{Rate limiting:} Detect rapid command sequences
    \item \textbf{Access control:} Restrict which systems can send commands
\end{itemize}

% ----------------------------------------------------------------------------
%  LESSONS LEARNED
% ----------------------------------------------------------------------------

\section{Lessons Learned}

\begin{enumerate}
    \item \textbf{Automation increases risk:} Malware can attack faster than humans respond
    \item \textbf{Protocol knowledge is weaponized:} Attackers invest in understanding ICS protocols
    \item \textbf{Defense in depth is essential:} Single controls are insufficient
    \item \textbf{Visibility matters:} Many victims lacked monitoring capability
    \item \textbf{Recovery planning is critical:} Manual restoration procedures saved the day
\end{enumerate}

% ----------------------------------------------------------------------------
%  FURTHER READING
% ----------------------------------------------------------------------------

\section{Further Reading}

\subsection*{Technical Reports}
\begin{itemize}
    \item \textbf{ESET} -- Industroyer Analysis\\
          \url{https://www.welivesecurity.com/2017/06/12/industroyer-biggest-threat-industrial-control-systems-since-stuxnet/}
    \item \textbf{Dragos} -- CrashOverride Report\\
          \url{https://www.dragos.com/resources/whitepaper/crashoverride-analyzing-the-malware-that-attacks-power-grids/}
\end{itemize}

\subsection*{Government Resources}
\begin{itemize}
    \item \textbf{CISA} -- ICS-CERT Alerts\\
          \url{https://www.cisa.gov/news-events/ics-alerts}
\end{itemize}

\subsection*{Books}
\begin{itemize}
    \item Andy Greenberg -- \textit{Sandworm} (Doubleday)
\end{itemize}

\vfill
\begin{center}
\textcolor{mediumgray}{\rule{0.5\textwidth}{0.5pt}}\\[1em]
\textcolor{mediumgray}{\small Part of the OT Security Learning Series}
\end{center}

\end{document}
